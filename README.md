# PNG-2LPTic

The original of [PNG-2LPTic](https://github.com/SiyiZhao/PNG-2LPTic) is the [2LPTnonlocal code](https://cosmo.nyu.edu/roman/2LPT/) from Roman Scoccimarro.

## Updates

### with Drew Jamieson's version

Updated with the version used in Quijote simulations (https://github.com/dsjamieson/2LPTPNG) with following things:
- Enable FixedAmplitude and PhaseFlip;
- Add ns!=1 capability for all PNG cases;
- Change `drfftw` to `rfftw` since double precision is not needed;
- Delete `FnlTime`, `DstartFnl`, `RedshiftFnl`, since they should be in $z=0$ (important change);
- Add timing of the code.

There are also some changes appeared in the Quijote version but I do not adopt: 
- They delete some *information printing*, I keep them in this version.
- They set up `Makefile` with system specific options ("flatiron" & "GordonS"), I keep the original `Makefile` in this version.

### Cosmological Collider (Sam Goldstein's version)

To include cosmological collider type models, updated with [2LPTPNGic_Collider](https://github.com/samgolds/2LPTPNGic_Collider), the Modified version of [2LPTPNGic](https://github.com/dsjamieson/2LPTPNG) from Samuel Goldstein.

The main changes are:
- Add Quasi-Single Field (QSF) and Oscillation (OSC) models;
- The coding style is more standardized.
- Add the ability to output the linear density field generated by N-GenIC

Goldstein's version is based on Quijote's version, so the un-adopted changes mentioned above are remain.
Addtionally, I keep the `EXEC` name as `2LPTNGOSC` in `OSC_FNL` mode, without change to `2LPTNGOSC_TANH` as [this commit](https://github.com/samgolds/2LPTPNGic_Collider/commit/0ca0f7469c3aa7b1aebd42f8e0b3554e0cbbaa5e#diff-cf811f306dd32f98aedd416aeb5b0d5514761337b44acc193d73e148640851e4) did.

(Note that the first commit of `2LPTPNGic_Collider` has bug, `kdeltaphi` is not defined in `OSC_FNL` mode.)